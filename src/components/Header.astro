---
import { Icon } from 'astro-icon/components';
import LanguageSelector from './LanguageSelector.astro';
import LogoAndName from './LogoAndName.astro';
import { useTranslations } from "@/i18n/utils";
import { languageList } from "@/i18n/ui";

const currentLang = Astro.currentLocale || "es";

const translateLabels = useTranslations(
  currentLang as keyof typeof languageList
);
const navMenu = translateLabels("nav.menu");

---

<header class="fixed top-0 w-full transition-all duration-300 z-30" id="header">
  <div class="container mx-auto px-4 flex items-center h-16">
    <button 
      id="sidebar-toggle" 
      class="p-2 hover:bg-accent/10 rounded-lg transition-colors mr-4"
      aria-label={navMenu}
    >
      <Icon name="mdi:menu" class="w-6 h-6" />
    </button>

    <LogoAndName />

    <div class="flex items-center gap-4 ml-auto">
      <LanguageSelector />
      <slot name="actions" />
    </div>
  </div>
</header>

<script>
  const header = document.getElementById('header');
  let lastScroll = 0;

  window.addEventListener('scroll', () => {
    const currentScroll = window.pageYOffset;

    if (currentScroll > 50) {
      header.classList.add(
        'bg-light/70',
        'dark:bg-dark/70',
        'backdrop-blur-md',
        'shadow-lg'
      );
    } else {
      header.classList.remove(
        'bg-light/70',
        'dark:bg-dark/70',
        'backdrop-blur-md',
        'shadow-lg'
      );
    }

    if (currentScroll > lastScroll && currentScroll > 100) {
      header.style.transform = 'translateY(-100%)';
    } else {
      header.style.transform = 'translateY(0)';
    }

    lastScroll = currentScroll;
  });
</script>