---
// src/pages/eventos/[slug].astro
// Esta es la p√°gina de detalle para un evento espec√≠fico con un dise√±o completamente nuevo.
import Layout from '../../layouts/Layout.astro'; // Aseg√∫rate de que la ruta a tu Layout sea correcta
import { eventos } from '../../data/eventos'; // Importa tus datos de eventos

// Esta funci√≥n es REQUERIDA para rutas din√°micas
export async function getStaticPaths() {
  return Object.keys(eventos).map((id) => ({
    params: { id },
    props: { evento: eventos[id as keyof typeof eventos] }
  }));
}

const { evento } = Astro.props;

if (!evento) {
  // Si el evento no se encuentra, redirige a una p√°gina 404
  return Astro.redirect('/404');
}

// Prepara el t√≠tulo y subt√≠tulo para una mejor presentaci√≥n
const mainTitle = evento.titulo.split(': ')[0];
const subTitle = evento.titulo.split(': ').length > 1 ? evento.titulo.split(': ')[1] : '';
---

<Layout title={`${evento.titulo} - Somos`}>
  <!-- Main content area with padding to clear the fixed header -->
  <!-- Adjust pt-20 and sm:pt-24 based on your actual header height -->
  <main class="bg-light dark:bg-dark pt-20 sm:pt-24 min-h-screen">

    <!-- Hero Section: Featured Image & Main Title -->
    <section class="relative w-full overflow-hidden bg-dark dark:bg-gray-900 py-8 sm:py-12 lg:py-16">
      <div class="container mx-auto px-4">
        <!-- Image container - now dynamic height to show full image -->
        <div class="relative w-full rounded-xl overflow-hidden shadow-xl-dark mb-8 flex justify-center items-center bg-gray-700 dark:bg-gray-900">
          <picture>
            <!-- Mobile image -->
            <source media="(max-width: 768px)" srcset={evento.imagenMovil}>
            <!-- Desktop image -->
            <img
              src={evento.imagen || "/placeholder.svg"}
              alt={evento.titulo}
              class="w-full h-auto object-contain"
            >
          </picture>
          <!-- Subtle overlay on image (optional, might not be needed with object-contain) -->
          <!-- <div class="absolute inset-0 bg-dark opacity-20"></div> -->
        </div>

        <!-- Main Title and Subtitle -->
        <div class="text-center mb-8">
          <span class="inline-block bg-accent text-dark px-4 py-2 rounded-full text-sm font-semibold mb-4 shadow-lg animate-fade-in">
            ‚ú® Evento Especial
          </span>
          <h1 class="font-display font-extrabold text-dark dark:text-light mb-4 leading-tight animate-slide-up">
            <span class="block text-4xl sm:text-6xl lg:text-7xl">
              {mainTitle}
            </span>
            {subTitle && (
              <span class="block text-2xl sm:text-4xl lg:text-5xl font-light mt-2 text-dark/80 dark:text-light/80">
                {subTitle}
              </span>
            )}
          </h1>
          <div class="flex flex-col sm:flex-row gap-4 justify-center mt-8 animate-slide-up">
            <a
              href="#registro"
              class="bg-accent text-dark font-bold py-3 px-8 rounded-full hover:bg-opacity-90 transition-colors duration-300 shadow-lg transform hover:scale-105 active:scale-95 text-lg"
            >
              Registrarse por {evento.precio}
            </a>
            <a
              href="#detalles"
              class="bg-light/20 hover:bg-light/30 backdrop-blur-sm text-dark dark:text-light font-semibold py-3 px-8 rounded-full transition-colors duration-300 border border-dark/30 dark:border-light/30 text-lg transform hover:scale-105 active:scale-95"
            >
              Ver m√°s detalles
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Content Area: Details, Speaker, Registration -->
    <div class="container mx-auto px-4 py-12 sm:py-16 lg:py-20">
      <div class="lg:grid lg:grid-cols-3 lg:gap-12">

        <!-- Left Column: Event Details & Speaker Info -->
        <div class="lg:col-span-2 space-y-10">

          <!-- Event Details Section -->
          <section id="detalles" class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border border-dark/5 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-8 text-center">
              Detalles del Evento
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Date Card -->
              <div class="flex items-center gap-4 bg-secondary/20 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Fecha</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.fecha}</p>
                </div>
              </div>
              <!-- Time Card -->
              <div class="flex items-center gap-4 bg-secondary/20 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Horario</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.horario}</p>
                </div>
              </div>
              <!-- Location Card -->
              <div class="flex items-center gap-4 bg-secondary/20 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Ubicaci√≥n</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.lugar}</p>
                </div>
              </div>
              <!-- Price Card -->
              <div class="flex items-center gap-4 bg-secondary/20 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Entrada</h3>
                  <p class="font-display text-xl font-bold text-accent">{evento.precio}</p>
                </div>
              </div>
            </div>
          </section>

          <!-- About Event Section -->
          <section class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border border-dark/5 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-6">
              Sobre la Conferencia
            </h2>
            <p class="text-dark/80 dark:text-light/80 text-lg leading-relaxed mb-4">
              {evento.descripcion.split('Estar√° con nosotros,')[0]}
            </p>
            <p class="text-dark/80 dark:text-light/80 text-lg leading-relaxed">
              √önete a nosotros para una experiencia inolvidable y aut√©ntica.
            </p>
          </section>

          <!-- About Speaker Section -->
          <section class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border border-dark/5 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-6">
              Sobre el Ponente
            </h2>
            <div class="flex items-center gap-6">
              <div class="bg-accent p-4 rounded-full flex-shrink-0">
                <svg class="h-8 w-8 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                </svg>
              </div>
              <div>
                <h3 class="font-display text-2xl sm:text-3xl font-bold text-dark dark:text-light mb-2">
                  {evento.ponente}
                </h3>
                <p class="text-dark/70 dark:text-light/70 text-base leading-relaxed">
                  Antrop√≥loga y comunicadora reconocida a nivel internacional, especializada en salud mental y espiritualidad.
                </p>
              </div>
            </div>
          </section>

        </div>

        <!-- Right Column: Registration Form (Sticky on larger screens) -->
        <div class="lg:col-span-1 mt-10 lg:mt-0">
          <div class="lg:sticky lg:top-24"> <!-- Adjust lg:top-24 based on your header height -->
            <div id="registro" class="bg-secondary p-6 sm:p-8 rounded-xl shadow-lg border-2 border-accent dark:bg-gray-800 dark:border-light">
              <div class="text-center mb-6">
                <h3 class="font-display text-2xl font-bold text-dark dark:text-light mb-2">
                  Reserva tu lugar
                </h3>
                <p class="text-dark/60 dark:text-light/60 text-base">
                  √önete a esta experiencia transformadora
                </p>
              </div>
              
              <form id="registration-form" class="space-y-4">
                <div>
                  <label for="nombre" class="block text-sm font-semibold text-dark dark:text-light mb-2">
                    Nombre completo <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="nombre"
                    name="nombre"
                    required
                    class="w-full px-4 py-3 rounded-xl border-2 border-dark/10 dark:border-light/20 bg-light dark:bg-dark text-dark dark:text-light focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-300"
                    placeholder="Tu nombre completo"
                  >
                </div>
                
                <div>
                  <label for="telefono" class="block text-sm font-semibold text-dark dark:text-light mb-2">
                    Tel√©fono <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="tel"
                    id="telefono"
                    name="telefono"
                    required
                    class="w-full px-4 py-3 rounded-xl border-2 border-dark/10 dark:border-light/20 bg-light dark:bg-dark text-dark dark:text-light focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-300"
                    placeholder="+34 600 000 000"
                  >
                </div>
                
                <div>
                  <label for="correo" class="block text-sm font-semibold text-dark dark:text-light mb-2">
                    Correo electr√≥nico <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="email"
                    id="correo"
                    name="correo"
                    required
                    class="w-full px-4 py-3 rounded-xl border-2 border-dark/10 dark:border-light/20 bg-light dark:bg-dark text-dark dark:text-light focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-300"
                    placeholder="tu@email.com"
                  >
                </div>
                
                <div>
                  <label for="procedencia" class="block text-sm font-semibold text-dark dark:text-light mb-2">
                    ¬øDe d√≥nde nos visitas? <span class="text-red-500">*</span>
                  </label>
                  <input
                    type="text"
                    id="procedencia"
                    name="procedencia"
                    required
                    class="w-full px-4 py-3 rounded-xl border-2 border-dark/10 dark:border-light/20 bg-light dark:bg-dark text-dark dark:text-light focus:ring-2 focus:ring-accent focus:border-accent transition-all duration-300"
                    placeholder="Ciudad, pa√≠s"
                  >
                </div>
                
                <!-- Precio visible en el bot√≥n -->
                <button
                  type="submit"
                  class="w-full bg-accent hover:bg-accent/90 text-dark font-bold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl"
                >
                  üéüÔ∏è Registrarse por {evento.precio}
                </button>
                
                <p class="text-xs text-dark/50 dark:text-light/50 text-center leading-relaxed">
                  Al registrarte, aceptas nuestros t√©rminos y condiciones.<br>
                  Te contactaremos para confirmar tu registro.
                </p>
              </form>
            </div>
          </div>
        </div>

      </div>
    </div>
  </main>
</Layout>

<script>
  // Smooth scroll
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });

  // Form handling
  document.getElementById('registration-form')?.addEventListener('submit', function(e) {
    e.preventDefault();
    
    const formData = new FormData(this as HTMLFormElement);
    const data = Object.fromEntries(formData);
    
    console.log('Datos de registro:', data);
    
    const button = this.querySelector('button[type="submit"]');
    const originalText = button?.textContent;
    
    if (button) {
      button.textContent = '‚úÖ ¬°Registro exitoso!';
      button.disabled = true;
      button.classList.add('bg-green-500', 'hover:bg-green-500');
      
      setTimeout(() => {
        button.textContent = originalText;
        button.disabled = false;
        button.classList.remove('bg-green-500', 'hover:bg-green-500');
        (this as HTMLFormElement).reset();
      }, 3000);
    }
  });
</script>
