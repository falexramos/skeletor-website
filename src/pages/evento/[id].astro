---
// src/pages/eventos/[id].astro
// Esta es la página de detalle para un evento específico con un diseño completamente nuevo.
import Layout from '@/layouts/Layout.astro';
import { eventos, type Evento } from '@/data/eventos';

// Esta función es REQUERIDA para rutas dinámicas
export function getStaticPaths() {

  const paths = eventos.map((evento) => ({
    params: { id: evento.id },
    props: { evento },
  }));


  return paths;
}

const { evento } = Astro.props as { evento: Evento };


if (!evento) {
  // Si el evento no se encuentra, redirige a una página 404
  return Astro.redirect('/404');
}

// Prepara el título y subtítulo para una mejor presentación
const mainTitle = evento.titulo.split(': ')[0];
const subTitle = evento.titulo.split(': ').length > 1 ? evento.titulo.split(': ')[1] : '';
const finalPrice = `${evento.unitPrice}€`;
---

<Layout title={`${evento.titulo} - Somos`}>
  <!-- Main content area with padding to clear the fixed header -->
  <!-- Adjust pt-20 and sm:pt-24 based on your actual header height -->
  <main class="bg-white dark:bg-dark pt-20 sm:pt-24 min-h-screen">

    <!-- Hero Section: Featured Image & Main Title -->
    <section class="relative w-full overflow-hidden bg-secondary dark:bg-gray-900 py-8 sm:py-12 lg:py-16">
      <div class="container mx-auto px-4">
        <!-- Image container - now dynamic height to show full image -->
        <div class="relative w-full rounded-xl overflow-hidden shadow-xl-dark mb-8 flex justify-center items-center bg-gray-700 dark:bg-gray-900">
          <picture>
            <!-- Mobile image -->
            <source media="(max-width: 768px)" srcset={evento.imagenMovil}>
            <!-- Desktop image -->
            <img
              src={evento.imagen || "/placeholder.svg"}
              alt={evento.titulo}
              class="w-full h-auto object-contain"
            >
          </picture>
        </div>

        <!-- Main Title and Subtitle -->
        <div class="text-center mb-8">
          <span class="inline-block bg-accent text-dark px-4 py-2 rounded-full text-sm font-semibold mb-4 shadow-lg animate-fade-in">
            ✨ Evento Especial
          </span>
          <h1 class="font-display font-extrabold text-dark dark:text-light mb-4 leading-tight animate-slide-up">
            <span class="block text-4xl sm:text-6xl lg:text-7xl">
              {mainTitle}
            </span>
            {subTitle && (
              <span class="block text-2xl sm:text-4xl lg:text-5xl font-light mt-2 text-dark/80 dark:text-light/80">
                {subTitle}
              </span>
            )}
          </h1>
          <div class="flex flex-col sm:flex-row gap-4 justify-center mt-8 animate-slide-up">
            <a
              href="#registro"
              class="bg-accent text-dark font-bold py-3 px-8 rounded-full hover:bg-opacity-90 transition-colors duration-300 shadow-lg transform hover:scale-105 active:scale-95 text-lg"
            >
              Registrarse
            </a>
            <a
              href="#detalles"
              class="bg-light/20 hover:bg-light/30 backdrop-blur-sm text-dark dark:text-light font-semibold py-3 px-8 rounded-full transition-colors duration-300 border border-dark/30 dark:border-light/30 text-lg transform hover:scale-105 active:scale-95"
            >
              Ver más detalles
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- Main Content Area: Details, Speaker, Registration -->
    <div class="container mx-auto px-4 py-12 sm:py-16 lg:py-20">
      <div class="lg:grid lg:grid-cols-3 lg:gap-12">

        <!-- Left Column: Event Details & Speaker Info -->
        <div class="lg:col-span-2 space-y-10">

          <!-- Event Details Section -->
          <section id="detalles" class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border-2 border-gray-100 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-8 text-center">
              Detalles del Evento
            </h2>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
              <!-- Date Card -->
              <div class="flex items-center gap-4 bg-gray-50 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Fecha</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.fecha}</p>
                </div>
              </div>
              <!-- Time Card -->
              <div class="flex items-center gap-4 bg-gray-50 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Horario</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.horario}</p>
                </div>
              </div>
              <!-- Location Card -->
              <div class="flex items-center gap-4 bg-gray-50 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="bg-accent p-3 rounded-full flex-shrink-0">
                  <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path>
                  </svg>
                </div>
                <div>
                  <h3 class="font-bold text-dark dark:text-light mb-1">Ubicación</h3>
                  <p class="text-dark/70 dark:text-light/70">{evento.lugar}</p>
                </div>
              </div>
              <!-- Price Card - Updated with dynamic price logic -->
              <div class="flex flex-col items-start gap-4 bg-gray-50 dark:bg-secondary/10 rounded-lg p-4 border border-secondary/30">
                <div class="flex items-center gap-4">
                  <div class="bg-accent p-3 rounded-full flex-shrink-0">
                    <svg class="h-6 w-6 text-dark" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2z"></path>
                    </svg>
                  </div>
                  <div>
                    <h3 class="font-bold text-dark dark:text-light mb-1">Entrada</h3>
                    <p class="font-display text-2xl font-bold dark:text-accent text-dark">{finalPrice}</p>
                  </div>
                </div>
               
              </div>
            </div>
          </section>

          <!-- About Event Section -->
          <section class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border-2 border-gray-100 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-6">
              Sobre la Conferencia
            </h2>
            <!-- Iterate over the description array to create multiple paragraphs -->
            {evento.descripcion.map((paragraph) => (
              <p class="text-dark/80 dark:text-light/80 text-lg leading-relaxed mb-4 text-justify">
                {paragraph}
              </p>
            ))}
          </section>

          <!-- About Speaker Section -->
          <section class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border-2 border-gray-100 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-6">
              Sobre el Ponente
            </h2>
            <div class="flex items-center gap-6">
              <div class="w-20 h-20 flex-shrink-0 rounded-full overflow-hidden border-4 border-accent shadow-lg">
                <img src="/assets/img/avatar_izanami.JPG" alt="Avatar del ponente" class="w-full h-full object-cover">
              </div>
              <div>
                <h3 class="font-display text-2xl sm:text-3xl font-bold text-dark dark:text-light mb-2">
                  {evento.ponente}
                </h3>
                <p class="text-dark/70 dark:text-light/70 text-base leading-relaxed mb-4 text-justify">
                  Izanami es TedX Speaker y ha sido seleccionada como una de las 100 personas más creativas por FORBES. Especializada en neurociencia y en el comportamiento humano, Izanami explora el por qué antropológico de que sigamos viviendo a medias y propone las herramientas para transformar la realidad que creamos hacia la máxima expresión de nuestro Ser.
                </p>
                <p class="text-dark/70 dark:text-light/70 text-base leading-relaxed mb-4 text-justify">
                  Izanami cuenta con 2 millones de seguidores en sus redes sociales, es una tendencia.
                </p>
                <a href="https://www.instagram.com/sarab.rey/" target="_blank" class="inline-flex items-center gap-2 text-dark dark:text-light hover:text-accent transition-colors duration-300">
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="currentColor" class="w-6 h-6">
                    <path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.624 4.909 4.84.058 1.267.067 1.647.067 4.851s-.009 3.583-.067 4.849c-.138 3.215-1.657 4.692-4.909 4.84-1.266.058-1.646.067-4.85.067s-3.583-.009-4.85-.067c-3.252-.148-4.77-1.624-4.909-4.84-.058-1.267-.067-1.647-.067-4.851s.009-3.583.067-4.849c.139-3.215 1.658-4.692 4.91-4.84 1.266-.058 1.646-.067 4.849-.067zm0-2.163c-3.259 0-3.667.014-4.943.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.271-.073 1.68-.073 4.944s.014 3.673.072 4.943c.2 4.358 2.618 6.78 6.98 6.98 1.271.059 1.68.073 4.944.073s3.673-.014 4.943-.072c4.358-.2 6.78-2.618 6.979-6.98.059-1.271.073-1.68.073-4.944s-.014-3.672-.072-4.943c-.2-4.358-2.618-6.78-6.979-6.98-1.271-.059-1.68-.073-4.944-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.162 6.162 6.162 6.162-2.759 6.162-6.162-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4s1.791-4 4-4 4 1.79 4 4-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.44-.645 1.44-1.44s-.645-1.44-1.44-1.44z"></path>
                  </svg>
                  
                </a>
              </div>
            </div>
          </section>
          <!-- Additional 'About Event' Section with a specific donation message -->
          <section class="bg-white dark:bg-dark/50 rounded-xl shadow-lg p-6 sm:p-8 border-2 border-gray-100 dark:border-light/10">
            <h2 class="font-display text-3xl sm:text-4xl font-bold text-dark dark:text-light mb-6">
              Sobre el evento
            </h2>
            <p class="text-dark/80 dark:text-light/80 text-lg leading-relaxed mb-4">
              El evento tiene un donativo de 20€ para poder hacer tu reserva.
            </p>
          </section>
        </div>

        <!-- Right Column: Registration Form (Sticky on larger screens) -->
        <div class="lg:col-span-1 mt-10 lg:mt-0">
          <div class="lg:sticky lg:top-24"> <!-- Adjust lg:top-24 based on your header height -->
            <!-- Updated form container classes for better light mode contrast -->
            <div id="registro" class="bg-white p-6 sm:p-8 rounded-xl shadow-lg border-2 border-gray-200 dark:bg-gray-800 dark:border-light">
              <div class="text-center mb-6">
                <h3 class="font-display text-2xl font-bold text-dark dark:text-light mb-2">
                  Reserva tu lugar
                </h3>
                <p class="text-dark/60 dark:text-light/60 text-base">
                  Únete a esta experiencia transformadora
                </p>
              </div>
              
              
              <a
                href={`/evento/${evento.id}/registro`}
                class="w-full bg-accent hover:bg-accent/90 text-dark font-bold py-4 px-6 rounded-xl transition-all duration-300 shadow-lg hover:shadow-xl text-center block"
              >
                Registrarse 
              </a>
              
              <p class="text-xs text-dark/50 dark:text-light/50 text-center leading-relaxed mt-4">
                Serás redirigido a la página de registro y pago.
              </p>
            </div>
          </div>
        </div> 

      </div>
    </div>
  </main>
</Layout>

<script>
  // Smooth scroll
  document.querySelectorAll('a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
      e.preventDefault();
      const target = document.querySelector(this.getAttribute('href'));
      if (target) {
        target.scrollIntoView({
          behavior: 'smooth',
          block: 'start'
        });
      }
    });
  });
</script>
